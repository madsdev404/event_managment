{% load static %}
<!DOCTYPE html>
<html lang="en" class="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Event Management System{% endblock title %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Noto+Sans+Bengali:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{% static 'css/output.css' %}" />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
    </style>
  </head>
  <body
    class="font-sans bg-background dark:bg-background-dark text-text-primary dark:text-text-primary-dark"
  >
    <header class="bg-surface dark:bg-surface-dark shadow-md">
      <nav class="container mx-auto px-6 py-3">
        <div class="flex justify-between items-center">
          <a
            href="{% url 'home' %}"
            class="text-xsm md:text-xl font-bold text-text-primary dark:text-text-primary-dark flex items-center"
          >
            Event Management
          </a>
          <div class="hidden md:flex space-x-4">
            <a
              href="{% url 'dashboard' %}"
              class="{% if request.resolver_match.url_name == 'dashboard' %}text-primary dark:text-primary-dark{% else %}text-text-muted dark:text-text-muted-dark{% endif %} hover:text-text-primary dark:hover:text-text-primary-dark"
              >Dashboard</a
            >
            <a
              href="{% url 'event_list' %}"
              class="{% if request.resolver_match.url_name == 'event_list' %}text-primary dark:text-primary-dark{% else %}text-text-muted dark:text-text-muted-dark{% endif %} hover:text-text-primary dark:hover:text-text-primary-dark"
              >Events</a
            >
            <a
              href="{% url 'category_list' %}"
              class="{% if request.resolver_match.url_name == 'category_list' %}text-primary dark:text-primary-dark{% else %}text-text-muted dark:text-text-muted-dark{% endif %} hover:text-text-primary dark:hover:text-text-primary-dark"
              >Categories</a
            >
            <a
              href="/admin/"
              class="text-text-muted dark:text-text-muted-dark hover:text-text-primary dark:hover:text-text-primary-dark"
              >Admin</a
            >
            {% if user.is_authenticated %}
              <a
                href="{% url 'logout' %}"
                class="text-text-muted dark:text-text-muted-dark hover:text-text-primary dark:hover:text-text-primary-dark"
                >Logout</a
              >
            {% else %}
              <a
                href="{% url 'login' %}"
                class="text-text-muted dark:text-text-muted-dark hover:text-text-primary dark:hover:text-text-primary-dark"
                >Login</a
              >
            {% endif %}
          </div>
          <div class="flex items-center gap-8">
            <button
              id="theme-toggle"
              type="button"
              class="text-text-muted dark:text-text-muted-dark hover:bg-background dark:hover:bg-surface-dark focus:outline-none focus:ring-4 focus:ring-border dark:focus:ring-border-dark rounded-lg text-sm p-2.5"
            >
              <svg
                id="theme-toggle-dark-icon"
                class="w-5 h-5 text-gray-100"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                viewBox="0 0 24 24"
              >
                <path
                  d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                ></path>
              </svg>
              <svg
                id="theme-toggle-light-icon"
                class="w-5 h-5 text-gray-900"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                viewBox="0 0 24 24"
              >
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
              </svg>
            </button>
            <div class="md:hidden ml-4">
              <button
                id="menu-toggle"
                class="text-text-muted dark:text-text-muted-dark hover:text-text-primary dark:hover:text-text-primary-dark focus:outline-none"
              >
                <svg
                  class="h-6 w-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 6h16M4 12h16m-7 6h7"
                  ></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <div id="mobile-menu" class="md:hidden hidden mt-4">
          <a
            href="{% url 'dashboard' %}"
            class="block py-2 {% if request.resolver_match.url_name == 'dashboard' %}text-primary dark:text-primary-dark{% else %}text-text-muted dark:text-text-muted-dark{% endif %} hover:text-text-primary dark:hover:text-text-primary-dark"
            >Dashboard</a
          >
          <a
            href="{% url 'event_list' %}"
            class="block py-2 {% if request.resolver_match.url_name == 'event_list' %}text-primary dark:text-primary-dark{% else %}text-text-muted dark:text-text-muted-dark{% endif %} hover:text-text-primary dark:hover:text-text-primary-dark"
            >Events</a
          >
          <a
            href="{% url 'category_list' %}"
            class="block py-2 {% if request.resolver_match.url_name == 'category_list' %}text-primary dark:text-primary-dark{% else %}text-text-muted dark:text-text-muted-dark{% endif %} hover:text-text-primary dark:hover:text-text-primary-dark"
            >Categories</a
          >
          <a
            href="/admin/"
            class="block py-2 text-text-muted dark:text-text-muted-dark hover:text-text-primary dark:hover:text-text-primary-dark"
            >Admin</a
          >
        </div>
      </nav>
    </header>
    <main class="min-h-screen pt-16">
      {% if messages %}
        <div class="container mx-auto px-6 py-4">
            {% for message in messages %}
                <div class="p-4 mb-4 text-sm text-blue-800 rounded-lg bg-blue-100" role="alert">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
      {% endif %}
      {% block content %} {% endblock content %}
    </main>

    <footer class="bg-gray-800 text-white py-12 mt-12">
      <div class="container mx-auto px-6">
        <div class="flex flex-wrap justify-between">
          <div class="w-full md:w-1/4 mb-8 md:mb-0">
            <h3 class="text-lg font-semibold mb-4">Event Management</h3>
            <p class="text-text-muted dark:text-text-muted-dark">
              Empowering teams with efficient event management solutions.
            </p>
          </div>
          <div class="w-full md:w-1/4 mb-8 md:mb-0">
            <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
            <ul class="text-text-muted dark:text-text-muted-dark space-y-2">
              <li>
                <a
                  href="{% url 'dashboard' %}"
                  class="hover:text-primary dark:hover:text-primary-dark"
                  >Dashboard</a
                >
              </li>
              <li>
                <a
                  href="{% url 'event_list' %}"
                  class="hover:text-primary dark:hover:text-primary-dark"
                  >Events</a
                >
              </li>
              <li>
                <a
                  href="{% url 'category_list' %}"
                  class="hover:text-primary dark:hover:text-primary-dark"
                  >Categories</a
                >
              </li>
            </ul>
          </div>
          <div class="w-full md:w-1/4 mb-8 md:mb-0">
            <h4 class="text-lg font-semibold mb-4">Connect</h4>
            <ul class="text-text-muted dark:text-text-muted-dark space-y-2">
              <li>
                <a
                  href="#"
                  class="hover:text-primary dark:hover:text-primary-dark"
                  >Twitter</a
                >
              </li>
              <li>
                <a
                  href="#"
                  class="hover:text-primary dark:hover:text-primary-dark"
                  >LinkedIn</a
                >
              </li>
              <li>
                <a
                  href="#"
                  class="hover:text-primary dark:hover:text-primary-dark"
                  >Facebook</a
                >
              </li>
            </ul>
          </div>
          <div class="w-full md:w-1/4">
            <h4 class="text-lg font-semibold mb-4">Newsletter</h4>
            <form class="flex">
              <input
                type="email"
                placeholder="Your email"
                class="w-full px-3 py-2 text-text-primary dark:text-text-primary-dark bg-surface dark:bg-surface-dark rounded-l-md focus:outline-none"
                required
              />
              <button
                type="submit"
                class="bg-primary hover:bg-primary-hover text-white px-4 py-2 rounded-r-md transition duration-300"
              >
                Subscribe
              </button>
            </form>
          </div>
        </div>
        <div
          class="border-t border-border dark:border-border-dark mt-12 pt-8 text-sm text-text-muted dark:text-text-muted-dark"
        >
          &copy; 2024 Event Management. All rights reserved.
        </div>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.getElementById("menu-toggle");
        if (menuToggle) {
          menuToggle.addEventListener("click", function () {
            const mobileMenu = document.getElementById("mobile-menu");
            if (mobileMenu) {
              mobileMenu.classList.toggle("hidden");
            }
          });
        }

        const userMenuButton = document.getElementById("user-menu-button");
        if (userMenuButton) {
          userMenuButton.addEventListener("click", function () {
            const userMenu = document.getElementById("user-menu");
            if (userMenu) {
              userMenu.classList.toggle("hidden");
            }
          });

          // Close the dropdown when clicking outside
          window.addEventListener("click", function (e) {
            const userMenu = document.getElementById("user-menu");
            if (
              userMenuButton &&
              userMenu &&
              !userMenuButton.contains(e.target)
            ) {
              userMenu.classList.add("hidden");
            }
          });
        }

        // Theme toggle logic
        const themeToggleBtn = document.getElementById("theme-toggle");
        const themeToggleDarkIcon = document.getElementById(
          "theme-toggle-dark-icon"
        );
        const themeToggleLightIcon = document.getElementById(
          "theme-toggle-light-icon"
        );

        if (themeToggleBtn) {
          // Check if the button exists
          // On page load or when changing themes, best to add inline to avoid flash
          if (
            localStorage.getItem("color-theme") === "dark" ||
            (!("color-theme" in localStorage) &&
              window.matchMedia("(prefers-color-scheme: dark)").matches)
          ) {
            document.documentElement.classList.add("dark");
            if (themeToggleLightIcon)
              themeToggleLightIcon.classList.add("hidden");
            if (themeToggleDarkIcon)
              themeToggleDarkIcon.classList.remove("hidden");
          } else {
            document.documentElement.classList.remove("dark");
            if (themeToggleDarkIcon)
              themeToggleDarkIcon.classList.add("hidden");
            if (themeToggleLightIcon)
              themeToggleLightIcon.classList.remove("hidden");
          }

          themeToggleBtn.addEventListener("click", function () {
            // toggle icons
            if (themeToggleDarkIcon)
              themeToggleDarkIcon.classList.toggle("hidden");
            if (themeToggleLightIcon)
              themeToggleLightIcon.classList.toggle("hidden");

            // if set via local storage previously
            if (localStorage.getItem("color-theme")) {
              if (localStorage.getItem("color-theme") === "light") {
                document.documentElement.classList.add("dark");
                localStorage.setItem("color-theme", "dark");
              } else {
                document.documentElement.classList.remove("dark");
                localStorage.setItem("color-theme", "light");
              }
              // if NOT set via local storage previously
            } else {
              if (document.documentElement.classList.contains("dark")) {
                document.documentElement.classList.remove("dark");
                localStorage.setItem("color-theme", "light");
              } else {
                document.documentElement.classList.add("dark");
                localStorage.setItem("color-theme", "dark");
              }
            }
          });
        }
      });
    </script>
  </body>
</html>
